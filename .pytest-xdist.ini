# pytest-xdist specific configuration for safe parallel execution

[pytest]
# Basic options
minversion = 8.0
testpaths = tests

# Parallel execution options
addopts = 
    -ra
    --strict-markers
    --maxfail=10
    # Don't show live logs in parallel mode
    --no-cov-on-fail
    # Disable output capturing for cleaner parallel output
    --tb=short
    
# Test distribution settings for xdist
[pytest:xdist]
# Use file-based distribution by default
dist = loadfile

# Group tests by file to minimize conflicts
group = file

# Disable boxed mode (can cause issues on Windows)
boxed = false

[pytest:ini]
# Timeout for individual tests (prevents hanging)
timeout = 300
timeout_method = thread

# Markers for test organization
markers =
    serial: marks tests that must run serially (not in parallel)
    parallel_safe: marks tests that are known to work well in parallel
    flaky: marks tests that may fail intermittently in parallel
    requires_isolation: marks tests that need complete isolation
    
# Coverage settings for parallel mode
[coverage:run]
parallel = true
concurrency = multiprocessing
data_file = .coverage.parallel

[coverage:paths]
# Map coverage paths for combining
source = 
    libs/
    */libs/
    
[coverage:report]
# Don't fail on coverage in parallel mode
fail_under = 0
