{
  "consumer": {
    "name": "BillingTest"
  },
  "interactions": [
    {
      "description": "a request for contract details",
      "pending": false,
      "providerStates": [
        {
          "name": "A contract exists"
        }
      ],
      "request": {
        "method": "GET",
        "path": "/api/v1/contracts/12345"
      },
      "response": {
        "body": {
          "content": {
            "created_at": "2025-01-01T00:00:00+00:00",
            "currency": "USD",
            "customer": {
              "email": "test@example.com",
              "id": "CUST001",
              "name": "Test Customer"
            },
            "id": "12345",
            "items": [
              {
                "description": "Compute Instance",
                "id": "ITEM001",
                "quantity": 1,
                "total": 100.0,
                "unit_price": 100.0
              }
            ],
            "status": "ACTIVE",
            "total_amount": 500.0,
            "updated_at": "2025-01-01T00:00:00+00:00"
          },
          "contentType": "application/json",
          "encoded": false
        },
        "headers": {
          "Content-Type": [
            "application/json"
          ]
        },
        "matchingRules": {
          "body": {
            "$.created_at": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "regex",
                  "regex": "\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\+\\d{2}:\\d{2}"
                }
              ]
            },
            "$.currency": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "regex",
                  "regex": "[A-Z]{3}"
                }
              ]
            },
            "$.customer.email": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "regex",
                  "regex": ".+@.+\\..+"
                }
              ]
            },
            "$.customer.id": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.customer.name": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.id": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "regex",
                  "regex": "[0-9]+"
                }
              ]
            },
            "$.items": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.items[*].description": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.items[*].id": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.items[*].quantity": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.items[*].total": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.items[*].unit_price": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.status": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "regex",
                  "regex": "(ACTIVE|INACTIVE|PENDING)"
                }
              ]
            },
            "$.total_amount": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.updated_at": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "regex",
                  "regex": "\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\+\\d{2}:\\d{2}"
                }
              ]
            }
          }
        },
        "status": 200
      },
      "type": "Synchronous/HTTP"
    },
    {
      "description": "a request for payment status",
      "pending": false,
      "providerStates": [
        {
          "name": "Payment exists"
        }
      ],
      "request": {
        "method": "GET",
        "path": "/api/v1/payments/PAY_ABC123"
      },
      "response": {
        "body": {
          "content": {
            "amount": 1500.0,
            "currency": "USD",
            "due_date": null,
            "invoice": {
              "id": "INV001",
              "url": "https://api.example.com/invoices/INV001"
            },
            "payment_id": "PAY_ABC123",
            "status": "PENDING"
          },
          "contentType": "application/json",
          "encoded": false
        },
        "generators": {
          "body": {
            "$.due_date": {
              "format": "yyyy-MM-dd",
              "type": "Date"
            }
          }
        },
        "headers": {
          "Content-Type": [
            "application/json"
          ]
        },
        "matchingRules": {
          "body": {
            "$.amount": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.currency": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.due_date": {
              "combine": "AND",
              "matchers": [
                {
                  "format": "yyyy-MM-dd",
                  "match": "date"
                }
              ]
            },
            "$.invoice.id": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.invoice.url": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "regex",
                  "regex": "https://.+/invoices/.+"
                }
              ]
            },
            "$.payment_id": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "regex",
                  "regex": "PAY_[0-9A-F]+"
                }
              ]
            },
            "$.status": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "regex",
                  "regex": "(PENDING|PROCESSING|COMPLETED|FAILED)"
                }
              ]
            }
          }
        },
        "status": 200
      },
      "type": "Synchronous/HTTP"
    },
    {
      "description": "a request to create a credit",
      "pending": false,
      "providerStates": [
        {
          "name": "Customer exists"
        }
      ],
      "request": {
        "body": {
          "content": {
            "amount": 500.0,
            "currency": "USD",
            "customer_id": "CUST001",
            "reason": "Monthly adjustment",
            "type": "ADJUSTMENT"
          },
          "contentType": "application/json",
          "encoded": false
        },
        "headers": {
          "Content-Type": [
            "application/json"
          ]
        },
        "method": "POST",
        "path": "/api/v1/credits"
      },
      "response": {
        "body": {
          "content": {
            "amount": 500.0,
            "created_at": "2025-01-01T00:00:00+00:00",
            "currency": "USD",
            "customer_id": "CUST001",
            "expires_at": "2025-01-01T00:00:00+00:00",
            "id": "CREDIT_12345",
            "status": "ACTIVE"
          },
          "contentType": "application/json",
          "encoded": false
        },
        "headers": {
          "Content-Type": [
            "application/json"
          ]
        },
        "matchingRules": {
          "body": {
            "$.amount": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.created_at": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "regex",
                  "regex": "\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\+\\d{2}:\\d{2}"
                }
              ]
            },
            "$.currency": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.customer_id": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.expires_at": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "regex",
                  "regex": "\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\+\\d{2}:\\d{2}"
                }
              ]
            },
            "$.id": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "regex",
                  "regex": "CREDIT_[0-9A-F]+"
                }
              ]
            },
            "$.status": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "regex",
                  "regex": "(ACTIVE|PENDING|APPLIED)"
                }
              ]
            }
          }
        },
        "status": 201
      },
      "type": "Synchronous/HTTP"
    },
    {
      "description": "adjustment application request",
      "pending": false,
      "providerStates": [
        {
          "name": "Invoice exists"
        }
      ],
      "request": {
        "body": {
          "content": {
            "amount": 100.0,
            "reason": "Promotional discount",
            "target_invoice": "INV001",
            "type": "DISCOUNT"
          },
          "contentType": "application/json",
          "encoded": false
        },
        "headers": {
          "Content-Type": [
            "application/json"
          ]
        },
        "method": "POST",
        "path": "/api/v1/adjustments"
      },
      "response": {
        "body": {
          "content": {
            "adjusted_amount": 1400.0,
            "adjustment_id": "ADJ_XYZ789",
            "applied_at": "2025-01-01T00:00:00+00:00",
            "original_amount": 1500.0,
            "status": "APPLIED"
          },
          "contentType": "application/json",
          "encoded": false
        },
        "headers": {
          "Content-Type": [
            "application/json"
          ]
        },
        "matchingRules": {
          "body": {
            "$.adjusted_amount": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.adjustment_id": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "regex",
                  "regex": "ADJ_[0-9A-F]+"
                }
              ]
            },
            "$.applied_at": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "regex",
                  "regex": "\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\+\\d{2}:\\d{2}"
                }
              ]
            },
            "$.original_amount": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            }
          }
        },
        "status": 201
      },
      "type": "Synchronous/HTTP"
    },
    {
      "description": "meter data submission",
      "pending": false,
      "providerStates": [
        {
          "name": "Resource exists"
        }
      ],
      "request": {
        "body": {
          "content": {
            "metadata": {
              "instance_type": "t2.micro",
              "region": "us-east-1"
            },
            "meter_name": "cpu.usage",
            "resource_id": "RES001",
            "timestamp": "2025-10-20T01:08:17.095866+00:00",
            "unit": "percent",
            "value": 85.5
          },
          "contentType": "application/json",
          "encoded": false
        },
        "headers": {
          "Content-Type": [
            "application/json"
          ]
        },
        "method": "POST",
        "path": "/api/v1/meters"
      },
      "response": {
        "body": {
          "content": {
            "id": "METER_67890",
            "resource_id": "RES001",
            "status": "ACCEPTED",
            "timestamp": "2025-01-01T00:00:00+00:00"
          },
          "contentType": "application/json",
          "encoded": false
        },
        "headers": {
          "Content-Type": [
            "application/json"
          ]
        },
        "matchingRules": {
          "body": {
            "$.id": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "regex",
                  "regex": "METER_[0-9A-F]+"
                }
              ]
            },
            "$.resource_id": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.timestamp": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "regex",
                  "regex": "\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\+\\d{2}:\\d{2}"
                }
              ]
            }
          }
        },
        "status": 201
      },
      "type": "Synchronous/HTTP"
    }
  ],
  "metadata": {
    "pactRust": {
      "ffi": "0.4.28",
      "models": "1.3.5"
    },
    "pactSpecification": {
      "version": "4.0"
    }
  },
  "provider": {
    "name": "BillingAPI"
  }
}
